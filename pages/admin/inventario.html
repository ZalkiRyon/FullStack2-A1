<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario - Huerto Hogar Admin</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- CSS Base -->
    <link rel="stylesheet" href="../../assets/css/base.css">
    <!-- CSS espec√≠fico del admin -->
    <link rel="stylesheet" href="../../assets/css/admin.css">
    
    <!-- Fuente de Google Montserrat -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    
    <!-- Fuente de Google Playfair Display -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
</head>
<body class="admin-body">
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="admin-logo">
                <img src="../../assets/images/icono.png" alt="Logo Huerto Hogar" class="logo-img">
                <span class="logo-text">Huerto Hogar</span>
            </div>
            
            <nav class="admin-nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="dashboard.html" class="nav-link">
                            <i class="nav-icon">üìä</i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="ordenes.html" class="nav-link">
                            <i class="nav-icon">üì¶</i>
                            <span>√ìrdenes</span>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a href="#" class="nav-link">
                            <i class="nav-icon">üìã</i>
                            <span>Inventario</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="reportes.html" class="nav-link">
                            <i class="nav-icon">üìà</i>
                            <span>Reportes</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="empleados.html" class="nav-link">
                            <i class="nav-icon">üë•</i>
                            <span>Empleados</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="listarUsuarios.html" class="nav-link">
                            <i class="nav-icon">üë§</i>
                            <span>Usuarios</span>
                        </a>
                    </li>
                </ul>
            </nav>
            
            <!-- Sidebar Footer -->
            <div class="admin-sidebar-footer">
                <div class="nav-item">
                    <a href="configuraciones.html" class="nav-link">
                        <i class="nav-icon">‚öôÔ∏è</i>
                        <span>Configuraciones</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="perfil.html" class="nav-link">
                        <i class="nav-icon">üîß</i>
                        <span>Perfil</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="buscar.html" class="nav-link">
                        <i class="nav-icon">üîç</i>
                        <span>Buscar</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="ayuda.html" class="nav-link">
                        <i class="nav-icon">üö™</i>
                        <span>Ayuda</span>
                    </a>
                </div>
                
                <!-- User Profile -->
                <div class="user-profile">
                    <div class="user-avatar">
                        <i class="user-icon">üë§</i>
                    </div>
                    <span class="user-name" id="adminUserInfo">Administrador Admin</span>
                    <button class="btn btn-sm btn-outline-danger mt-2" id="logoutButton">
                        Cerrar Sesi√≥n
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <div class="admin-header">
                <div class="header-content">
                    <h1 class="page-title">üìã Gesti√≥n de Inventario</h1>
                    <p class="page-subtitle">Administra el inventario de productos de Huerto Hogar</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" id="nuevoProductoBtn">
                        <span>‚ûï</span> Nuevo Producto
                    </button>
                </div>
            </div>

            <div class="admin-content">
                <!-- Tabla de productos -->
                <div class="table-container">
                    <div class="table-header">
                        <h3>Lista de Productos</h3>
                    </div>
                    
                    <!-- Filtros y b√∫squeda -->
                    <div class="filters-section mb-3">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="search-box">
                                    <input type="text" class="form-control" id="buscarProducto" placeholder="Buscar productos...">
                                    <span class="search-icon">üîç</span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select" id="filtroCategoria">
                                    <option value="">Todas las categor√≠as</option>
                                    <option value="Frutas frescas">Frutas frescas</option>
                                    <option value="Verduras organicas">Verduras org√°nicas</option>
                                    <option value="Productos organicos">Productos org√°nicos</option>
                                    <option value="Productos lacteos">Productos l√°cteos</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select" id="filtroStock">
                                    <option value="">Todos los stocks</option>
                                    <option value="bajo">Stock bajo (< 50)</option>
                                    <option value="medio">Stock medio (50-100)</option>
                                    <option value="alto">Stock alto (> 100)</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-outline-secondary w-100" id="limpiarFiltros">Limpiar</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table" id="tablaInventario">
                            <thead>
                                <tr>
                                    <th>Imagen</th>
                                    <th>C√≥digo</th>
                                    <th>Nombre</th>
                                    <th>Categor√≠a</th>
                                    <th>Precio</th>
                                    <th>Stock</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="tablaInventarioBody">
                                <!-- Los productos se cargar√°n din√°micamente aqu√≠ -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Controles de paginaci√≥n -->
                    <div id="paginationContainer" class="d-flex justify-content-between align-items-center mt-3" style="display: none !important;">
                        <div class="pagination-info">
                            <span id="paginationInfo" class="text-muted">Mostrando 0 de 0 productos</span>
                        </div>
                        <nav aria-label="Paginaci√≥n de productos">
                            <ul class="pagination pagination-sm mb-0" id="paginationControls">
                                <!-- Los controles se generar√°n din√°micamente -->
                            </ul>
                        </nav>
                        <div class="pagination-size">
                            <select id="pageSize" class="form-select form-select-sm" style="width: auto;">
                                <option value="5">5 por p√°gina</option>
                                <option value="10" selected>10 por p√°gina</option>
                                <option value="20">20 por p√°gina</option>
                                <option value="50">50 por p√°gina</option>
                            </select>
                        </div>
                    </div>

                    <!-- Mensaje cuando no hay productos -->
                    <div id="mensajeSinProductos" class="empty-state" style="display: none;">
                        <div class="empty-icon">üì¶</div>
                        <h3>No hay productos en el inventario</h3>
                        <p>Agrega tu primer producto para comenzar</p>
                        <button class="btn btn-primary" onclick="abrirModalProducto()">
                            ‚ûï Agregar Producto
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para crear/editar producto -->
    <div class="modal fade" id="modalProducto" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalProductoTitulo">Nuevo Producto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formProducto">
                        <input type="hidden" id="productoId">
                        
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="productoNombre" class="form-label">Nombre del producto *</label>
                                <input type="text" class="form-control" id="productoNombre" required>
                                <div class="invalid-feedback">El nombre es obligatorio</div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="productoCategoria" class="form-label">Categor√≠a *</label>
                                <select class="form-select" id="productoCategoria" required>
                                    <option value="">Seleccionar categor√≠a</option>
                                    <option value="Frutas frescas">Frutas frescas</option>
                                    <option value="Verduras organicas">Verduras org√°nicas</option>
                                    <option value="Productos organicos">Productos org√°nicos</option>
                                    <option value="Productos lacteos">Productos l√°cteos</option>
                                </select>
                                <div class="invalid-feedback">La categor√≠a es obligatoria</div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="productoPrecio" class="form-label">Precio ($) *</label>
                                <input type="number" class="form-control" id="productoPrecio" min="0" step="1" required>
                                <div class="invalid-feedback">El precio debe ser mayor a 0</div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="productoStock" class="form-label">Stock *</label>
                                <input type="number" class="form-control" id="productoStock" min="0" required>
                                <div class="invalid-feedback">El stock debe ser mayor o igual a 0</div>
                            </div>
                            
            <div class="col-md-6">
                <label for="productoImagen" class="form-label">Imagen</label>
                <div class="image-upload-container">
                    <!-- Preview de imagen -->
                    <div class="image-preview mb-2" id="imagePreview" style="display: none;">
                        <img id="previewImg" src="" alt="Preview" style="max-width: 100px; max-height: 100px; object-fit: cover; border-radius: 8px; border: 2px solid #ddd;">
                        <button type="button" class="btn btn-sm btn-outline-danger ms-2" id="removeImageBtn">Quitar</button>
                    </div>
                    
                    <!-- Selector de imagen predefinida -->
                    <select class="form-select mb-2" id="productoImagen">
                        <option value="">Sin imagen</option>
                        <option value="manzana.jpg">Manzana</option>
                        <option value="naranja.jpg">Naranja</option>
                        <option value="platano.jpg">Pl√°tano</option>
                        <option value="zanahoria.jpg">Zanahoria</option>
                        <option value="espinaca.jpg">Espinaca</option>
                        <option value="pimenton.jpg">Piment√≥n</option>
                        <option value="miel.jpg">Miel</option>
                        <option value="quinoa.jpg">Quinoa</option>
                        <option value="leche.jpg">Leche</option>
                    </select>
                    
                    <!-- Upload de imagen personalizada -->
                    <div class="custom-file-upload">
                        <input type="file" id="customImageUpload" accept="image/*" style="display: none;">
                        <button type="button" class="btn btn-outline-primary btn-sm w-100" id="uploadImageBtn">
                            üìÅ Cargar imagen personalizada
                        </button>
                    </div>
                    <small class="text-muted">Formatos: JPG, PNG, GIF (m√°x. 2MB)</small>
                </div>
            </div>                            <div class="col-12">
                                <label for="productoDescripcion" class="form-label">Descripci√≥n</label>
                                <textarea class="form-control" id="productoDescripcion" rows="3" placeholder="Descripci√≥n detallada del producto..."></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="guardarProductoBtn">Guardar Producto</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para ver detalle del producto -->
    <div class="modal fade" id="modalDetalleProducto" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalle del Producto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4">
                            <img id="detalleImagen" src="" alt="Producto" class="img-fluid rounded">
                        </div>
                        <div class="col-md-8">
                            <h4 id="detalleNombre"></h4>
                            <p class="text-muted" id="detalleCategoria"></p>
                            
                            <div class="product-details">
                                <div class="detail-item">
                                    <strong>Precio:</strong>
                                    <span id="detallePrecio"></span>
                                </div>
                                <div class="detail-item">
                                    <strong>Stock:</strong>
                                    <span id="detalleStock"></span>
                                </div>
                                <div class="detail-item">
                                    <strong>Estado:</strong>
                                    <span id="detalleEstado"></span>
                                </div>
                                <div class="detail-item">
                                    <strong>ID:</strong>
                                    <span id="detalleId"></span>
                                </div>
                            </div>
                            
                            <div class="mt-3">
                                <h6>Descripci√≥n:</h6>
                                <p id="detalleDescripcion"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-warning" id="editarDetalleBtn">‚úèÔ∏è Editar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Script espec√≠fico del inventario -->
    <script src="../../assets/js/inventario.js" type="module"></script>
    
    <!-- Script para cerrar sesi√≥n -->
    <script>
        document.getElementById('logoutButton').addEventListener('click', function() {
            if (confirm('¬øEst√°s seguro de que quieres cerrar sesi√≥n?')) {
                // Limpiar datos de sesi√≥n
                localStorage.removeItem('sesionActiva');
                localStorage.removeItem('usuarioActual');
                
                // Redirigir al login
                window.location.href = '../tienda/inicioSesion.html';
            }
        });
    </script>
</body>
</html>